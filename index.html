<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fight Me</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible+Next:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Atkinson Hyperlegible Next"', 'sans-serif'],
                    },
                },
            }
        }
    </script>
    
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js"></script>

    <style>
        :root {
            --background-color: #0c1a2c; /* Dark Blue/Slate */
            --surface-color: #1a2a3c;   /* Slightly lighter surface */
            --accent-color: #f59e0b;      /* Amber */
            --text-color: #ffffffde;
            --work-color: #f59e0b;      
            --rest-color: #10b981;      
            --warn-color: #fcd34d;      
        }
        body {
            font-family: 'Atkinson Hyperlegible Next', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            transition: all 0.3s ease;
        }
        #timer-display {
            font-size: clamp(3.5rem, 18vw, 9rem); 
            line-height: 1;
            font-weight: 900;
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.2); 
            transition: text-shadow 0.5s ease, color 0.5s ease;
            text-align: center;
            letter-spacing: -0.05em;
        }
        /* Custom scrollbar for better look */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--surface-color); }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }

        /* Style the select dropdown */
        select {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 1.25rem 1.25rem;
        }
        
        /* Volume Slider Customization */
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 14px;
            height: 14px;
            background: var(--accent-color);
            cursor: pointer;
            border-radius: 50%;
            margin-top: -5px; 
            box-shadow: 0 0 5px rgba(245, 158, 11, 0.6);
            transition: background 0.2s;
        }
        input[type=range]::-moz-range-thumb {
            width: 14px;
            height: 14px;
            background: var(--accent-color);
            cursor: pointer;
            border-radius: 50%;
            border: none;
            box-shadow: 0 0 5px rgba(245, 158, 11, 0.6);
            transition: background 0.2s;
        }
        input[type=range]::-webkit-slider-runnable-track {
            height: 4px;
            background: #475569;
            border-radius: 2px;
        }
        input[type=range]::-moz-range-track {
            height: 4px;
            background: #475569;
            border-radius: 2px;
        }

        /* Confetti Container Styling */
        #confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 60;
        }

        /* Basic Confetti Particle Style (CSS only for simplicity) */
        .confetti-piece {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: var(--accent-color);
            opacity: 0;
            animation: pop 2.5s ease-out forwards;
        }

        @keyframes pop {
            0% { transform: translateY(0) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0.5; }
        }
    </style>
<script type="importmap">
{
  "imports": {
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.25.0"
  }
}
</script>
</head>
<body class="min-h-screen flex items-center justify-center p-4 font-sans">

    <div id="confetti-container"></div>
    
    <div id="app" class="w-full max-w-sm sm:max-w-2xl bg-[--surface-color] shadow-2xl rounded-2xl p-6 sm:p-8 space-y-6 border border-slate-700">
        
        <header class="text-center flex justify-between items-center">
            <div class="w-1/5"></div> <div class="flex-grow">
                <h1 class="text-3xl sm:text-4xl font-extrabold text-white tracking-wide">Fight Me</h1>
                <p id="workout-name" class="text-lg sm:text-xl text-slate-400 mt-1">A boxing training app</p>
            </div>
            <div class="w-1/5 flex justify-end">
                <button id="fullscreen-btn" onclick="toggleFullscreen()" title="Toggle Fullscreen"
                    class="p-2.5 bg-slate-700 hover:bg-slate-600 rounded-full text-white transition duration-150 active:scale-95">
                    <i data-lucide="maximize" class="w-6 h-6" id="fullscreen-icon"></i>
                </button>
            </div>
        </header>

        <div id="combo-callout" class="text-center text-2xl sm:text-3xl text-amber-500 font-extrabold min-h-[50px] p-3 bg-slate-700/50 rounded-lg shadow-inner flex items-center justify-center">
            <span class="text-slate-400 text-base">Press Start to begin training!</span>
        </div>

        <div class="text-center py-2 space-y-2">
            <div id="total-time-display" class="text-lg text-slate-400 font-semibold tabular-nums">
                Total Remaining: 00:00
            </div>
            <div id="timer-display" class="font-extrabold text-white tracking-tighter tabular-nums transition-colors duration-500">
                03:00
            </div>
        </div>

        <div class="space-y-6 max-h-[60vh] overflow-y-auto">
            <div id="config-card" class="bg-slate-700 rounded-xl p-4 sm:p-6 space-y-6 shadow-xl opacity-100 transition-opacity duration-300">
                
                <div class="space-y-3 border-b border-slate-600 pb-4">
                    <h3 class="text-xl font-bold text-amber-400">Timer Settings</h3>
                    <div class="grid grid-cols-3 gap-3 sm:gap-4">
                        <div class="space-y-1">
                            <label for="round-duration" class="text-xs font-semibold text-slate-300 block">Round Mins</label>
                            <input type="number" id="round-duration" value="3" min="1" oninput="updateConfig()"
                                class="w-full bg-slate-800 text-white p-2 rounded-lg border-2 border-slate-600 focus:border-amber-500 transition duration-150 text-center">
                        </div>
                        <div class="space-y-1">
                            <label for="rest-duration" class="text-xs font-semibold text-slate-300 block">Rest Mins</label>
                            <input type="number" id="rest-duration" value="1" min="0" oninput="updateConfig()"
                                class="w-full bg-slate-800 text-white p-2 rounded-lg border-2 border-slate-600 focus:border-amber-500 transition duration-150 text-center">
                        </div>
                        <div class="space-y-1">
                            <label for="num-rounds" class="text-xs font-semibold text-slate-300 block">Total Rounds</label>
                            <input type="number" id="num-rounds" value="5" min="1" oninput="updateConfig()"
                                class="w-full bg-slate-800 text-white p-2 rounded-lg border-2 border-slate-600 focus:border-amber-500 transition duration-150 text-center">
                        </div>
                    </div>
                </div>

                <div class="space-y-4">
                    <h3 class="text-xl font-bold text-amber-400">Combo Logic Settings</h3>

                    <div class="space-y-2">
                        <label for="combo-length" class="text-sm font-semibold text-slate-300 block">1. Combo Length <span id="length-label" class="text-amber-300 ml-2 text-xs font-normal">Medium (1-4 Punches)</span></label>
                        <input type="range" id="combo-length-slider" min="0" max="2" value="1" step="1" oninput="updateConfig()"
                            class="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer range-lg focus:outline-none focus:ring-2 focus:ring-amber-500">
                        <div class="flex justify-between text-xs text-slate-400 pt-1">
                            <span>Low</span><span>Medium</span><span>High</span>
                        </div>
                    </div>

                    <div class="space-y-2">
                        <label for="combo-difficulty" class="text-sm font-semibold text-slate-300 block">2. Combo Difficulty <span id="difficulty-label" class="text-amber-300 ml-2 text-xs font-normal">Medium (Some Same-Side)</span></label>
                        <input type="range" id="combo-difficulty-slider" min="0" max="2" value="1" step="1" oninput="updateConfig()"
                            class="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer range-lg focus:outline-none focus:ring-2 focus:ring-amber-500">
                        <div class="flex justify-between text-xs text-slate-400 pt-1">
                            <span>Low</span><span>Medium</span><span>High</span>
                        </div>
                    </div>

                    <div class="space-y-2">
                        <label for="move-complexity" class="text-sm font-semibold text-slate-300 block">3. Move Complexity <span id="complexity-label" class="text-amber-300 ml-2 text-xs font-normal">Medium (Occasional Non-Punches)</span></label>
                        <input type="range" id="move-complexity-slider" min="0" max="2" value="1" step="1" oninput="updateConfig()"
                            class="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer range-lg focus:outline-none focus:ring-2 focus:ring-amber-500">
                        <div class="flex justify-between text-xs text-slate-400 pt-1">
                            <span>Low</span><span>Medium</span><span>High</span>
                        </div>
                    </div>
                </div>

                <div class="space-y-4 border-t border-slate-600 pt-4">
                    <h3 class="text-xl font-bold text-amber-400">Audio & Control Settings</h3>
                    
                    <div class="grid grid-cols-2 gap-4"> 
                        <div class="space-y-1">
                            <label for="combo-repetitions-select" class="text-xs font-semibold text-slate-300 block">4. Combo Intensity</label>
                            <select id="combo-repetitions-select" onchange="updateConfig()"
                                class="w-full bg-slate-800 text-white p-2 rounded-lg border-2 border-slate-600 focus:border-amber-500 transition duration-150 appearance-none pr-10">
                                <option value="1">Low (1x Repetition)</option>
                                <option value="2">Medium (2x Repetitions)</option>
                                <option value="3" selected>High (3x Repetitions)</option>
                            </select>
                        </div>

                        <div class="space-y-1">
                            <label for="voice-volume-slider" class="text-xs font-semibold text-slate-300 block">5. Voice Volume (<span id="voice-volume-label">100%</span>)</label>
                            <input type="range" id="voice-volume-slider" min="0" max="1" step="0.05" value="1" oninput="updateVoiceVolume()"
                                class="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer range-lg focus:outline-none focus:ring-2 focus:ring-amber-500">
                        </div>
                    </div> 
                    <div id="controls" class="flex flex-col space-y-3 pt-2">
                        <button id="start-btn" onclick="startTimer()" 
                            class="w-full p-4 bg-amber-500 hover:bg-amber-600 text-slate-900 text-xl font-bold rounded-xl shadow-lg transition duration-150 active:scale-95 flex items-center justify-center space-x-2">
                            <i data-lucide="play" class="w-6 h-6"></i>
                            <span>START ROUNDS</span>
                        </button>
                        <div class="flex space-x-3">
                            <button id="pause-btn" onclick="pauseTimer()" disabled 
                                class="flex-grow p-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-xl transition duration-150 active:scale-95 opacity-50 cursor-not-allowed flex items-center justify-center space-x-2">
                                <i data-lucide="pause" class="w-5 h-5"></i>
                                <span>Pause</span>
                            </button>
                            <button id="reset-btn" onclick="resetTimer()" 
                                class="flex-grow p-3 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-xl transition duration-150 active:scale-95 flex items-center justify-center space-x-2">
                                <i data-lucide="rotate-ccw" class="w-5 h-5"></i>
                                <span>Reset</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="info-card" class="bg-slate-700 rounded-xl p-4 sm:p-6 space-y-4 shadow-xl opacity-0 transition-opacity duration-300 pointer-events-none absolute inset-0 sm:relative sm:inset-auto sm:pointer-events-auto">
                
                <div class="flex justify-between items-center pb-2 border-b border-slate-600">
                    <div class="text-xl font-bold text-white">Round Progress</div>
                    <div class="text-lg font-semibold text-amber-300">Round <span id="current-round">1</span> / <span id="total-rounds">5</span></div>
                </div>
                <div class="grid grid-cols-2 gap-4 text-center">
                    <div class="p-4 bg-slate-800 rounded-lg">
                        <div class="text-xs font-semibold text-slate-400 uppercase">Phase</div>
                        <div id="phase-display" class="text-2xl font-extrabold text-amber-400 mt-1">Work</div>
                    </div>
                    <div class="p-4 bg-slate-800 rounded-lg">
                        <div class="text-xs font-semibold text-slate-400 uppercase">Next Callout In</div>
                        <div id="combo-countdown" class="text-2xl font-extrabold text-white mt-1 tabular-nums">0s</div>
                    </div>
                </div>

                <div class="pt-2 border-t border-slate-600">
                    <h4 class="text-lg font-bold text-slate-300 mb-2">Last Callout:</h4>
                    <p id="last-combo-display" class="text-base text-slate-400 font-mono italic">--</p>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="index.tsx"></script>
</body>
</html>
